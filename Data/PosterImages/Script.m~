for N = 14 : 100
    %%%%%%%%%%%%%%
    % Parameters %
    %%%%%%%%%%%%%%
    
    n = 4;
    x_a = 0;
    x_b = 20;
    y_a = 0;
    y_b = 20;
    m_x = 2 ^ 5;
    m_y = 2 ^ 5;
    
    %%%%%%%%%%%%
    % Computed %
    %%%%%%%%%%%%
    
    L = x_b;
    x_n = m_x * L + 1;
    y_n = m_y * L + 1;
    
    %%%%%%%%%%
    % Images %
    %%%%%%%%%%
    
    % I = GetImageOfPower(GetRandomPower(n, x_a, x_b, y_a, y_b, false), x_a, x_b, y_a, y_b, x_n, y_n);
    I = GetImageOfNonSeparable(GetRandomNonSeparable(n, L), L, x_n, y_n);
    
    %%%%%%%%%%
    % Saving %
    %%%%%%%%%%
    
    path = "/home/wjm/Documents/GitHub/ShapeReconstruction/Data/PosterImages/";
    mkdir(sprintf(path + "%i", N));
    imwrite(ind2rgb(im2uint8(mat2gray(I)), parula(256)), path + N + "/I.png");
    
    for psnr = [30, 50, 100]
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        % Down-Sample and Reconstructions %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        
        [R_V, ~, D] = VetterliReconstruction(I, x_a, x_b, y_a, y_b, x_n, y_n, psnr);
        R_B = GetImageOfNonSeparable(C_R_B, L, x_n, y_n);
        
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        % Pick the best non-separable reconstruction out of 100 %
        %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        
        best = - 1;
        for j = 1 : 25
            C_R_B = NonSeparableReconstruction(I, n, L, psnr);
            if SorensenDiceCoefficient(I, C_R_B) > best
                best = SorensenDiceCoefficient(I, C_R_B);
                C_R_B_best = C_R_B;
            end
        end
        
        imwrite(ind2rgb(im2uint8(mat2gray(D)), parula(256)), path + N + "/D.png");
        imwrite(ind2rgb(im2uint8(mat2gray(abs(I - R_B))), parula(256)), path + N + "/R_B_" + psnr + ".png");
        imwrite(ind2rgb(im2uint8(mat2gray(abs(I - R_V))), parula(256)), path + N + "/R_V_" + psnr + ".png");
    end
end